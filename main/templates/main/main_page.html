{% load crispy_forms_tags %}  
{% load static %}

<!DOCTYPE html>
<html lang="sl">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="{{page_data.page_data.description}}">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Google Tag Manager --> 
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': 
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], 
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= 
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); 
    })(window,document,'script','dataLayer','GTM-53MWT6RS');</script> 
    <!-- schema script -->
    <script type="application/ld+json"> 
    { 
        "@context": "https://schema.org", 
        "@type": "SoftwareApplication", 
        "name": "Pretvornik PDF v Word", 
        "description": "Brezplačen spletni pretvornik PDF v Word. Hitro in enostavno pretvorite dokumente v format Word brez registracije.", 
        "applicationCategory": "Utility", 
        "operatingSystem": "Web", 
        "offers": { 
            "@type": "Offer", 
            "price": "0", 
            "priceCurrency": "EUR" 
        }, 
        "url": "https://pretvori.si", 
        "featureList": [ 
            "Pretvorba PDF v Word", 
            "Brez registracije", 
            "Spletna pretvorba", 
            "Hitra obdelava" 
        ] 
    } 
    </script>

    <title>{{page_data.page_data.title}}</title>
    <link rel="stylesheet" href="{% static 'main/css/main_page_style.css' %}">
</head>
<body>
    <!-- Google Tag Manager (noscript) --> 
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-53MWT6RS" 
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>

    {% if not user.is_authenticated %}
        <div class="header-btns">
            <a href="{% url 'users_login' %}" class="btn login-btn">Prijava</a>
            <a href="{% url 'users_register' %}" class="btn signup-btn">Registracija</a>
        </div>
    {% else %}
        <div class="header-btns">
            <a href="{% url 'users_profile' %}" class="btn profile-btn">Profil</a>
        </div>
    {% endif %}
    <div class="main-wrap">
        <h1 class="main-title">
            {{page_data.page_data.h1}}
        </h1>
        <!-- container with form -->
        <div class="container">
            <!-- error box -->
            {% if submit_error %}
                <div id="error_box" class="error-box">{{form.file.errors.0}}</div>
            {% else %}
                <div id="error_box" class="error-box"></div>
            {% endif %}
            <!-- main form -->
            <form method="POST" class="main-form" id="main_form" enctype="multipart/form-data">
                {% csrf_token %}
                {{form.file}} 
                <label for="id_file" id="file_label" class="custom-file-upload">
                    Izberite datoteke ali spustite tukaj
                </label>
                <!-- divider -->
                <div style="width: 20px; height: 20px;"></div>
                <button class="blue-btn submit-btn hidden" id="file_send_button" type="submit">Pretvori</button>
            </form>
            <small class="loaded-file" id="loaded_file"></small>

            <!-- dowload button -->
            <div class="download-btn-wrapp">
                <button class="blue-btn download-btn hidden" id="download_btn" onclick="downloadFile()">
                    Prenesi
                </button>
            </div>
        </div>
        <!--* other info  -->
        <div class="other-info">
            {{page_data.other_info.text|safe}}
        </div>
    </div>

    <div class="footer">
        <div class="links">
            <a href="{% url 'questions_page' %}">Vprašanja (FAQ)</a>
            <a href="{% url 'blog_page' %}">Blog</a>
        </div>
    </div>

    <!-- layers separator -->
    {% if file_convertion_error %}    
        <div class="layers-separator" id="layers_separator"></div>
    {% else %}
        <div class="layers-separator hidden" id="layers_separator"></div>
    {% endif %}
    <!-- windows, ads that are in front -->

    <!-- ad -->
    <div class="ad-wrapper hidden" style="display: none;" id="ad_wrapper">
        <!-- creating ad image and link -->
        <a href="{{ad_model.url}}" target="_blank">
            {% if ad_model.content_file %}
                <!-- show ad as image, gif, video -->
                {% if ad_model.content_type == "image" %}
                    <img class="image" src="{{ad_model.content_file.url}}">
                {% elif ad_model.content_type == "gif" %}
                    <img class="gif" src="{{ad_model.content_file.url}}">
                {% elif ad_model.content_type == "video" %}
                    <video class="video" autoplay muted loop>
                        <source src="{{ad_model.content_file.url}}" type="video/{{ad_model.video_type}}">
                    </video>
                {% endif %}
            {% else %}
                <img src="{{ad_model.image_url}}">
            {% endif %}
        </a>
        
        <button class="close-btn" id="close_btn" onclick="closeAd()">
            <div class="close hidden" id="close_ad_text">
                ZAPRTO
            </div>
            <div class="progress-title" id="progress_title">
                Pretvarjanje<span class="dot">.</span><span class="dot">.</span><span class="dot">.</span>
            </div>
        </button>
    </div>

    <!-- send user register -->
    {% if file_convertion_error %}
    <div class="user-register-to-load-more-wrap">
        <div>Za pretvorbo več datotek se <a href="{% url 'users_register' %}">Registrirajte</a></div>
    </div>
    {% endif %}

    <div class="user-register-to-load-scaned-wrap hidden" id="register_to_download_box">
        <div>Za pretvorbo skeniranih datotek <a href="{% url 'users_register' %}">Registrirajte</a></div>
    </div>

    <script
        id="main-script"
        data-wait-for-task-done="{{ wait_for_task_done }}"
        data-task-id="{{ task_id }}"
        data-task-access-token="{{ task_access_token }}"
        src="{% static 'main/js/main_page_script.js' %}">
    </script>
</body>
</html>